-- zenscript 3-tab UI with Safe Zone, No Clip, Infinite Jump, Super Speed + Slider, ESP
local Library = loadstring(game:HttpGet("https://raw.githubusercontent.com/WHOLEBAKERY/zenlib/refs/heads/main/zenlib"))()

local Window = Library.Window("Zenscript UI")

local Players = game:GetService("Players")
local UIS = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local player = Players.LocalPlayer
local playerGui = player:WaitForChild("PlayerGui")

local screenGui = Instance.new("ScreenGui")
screenGui.Name = "SafeZoneGUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = playerGui
screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

-- ======================
-- Safe Zone Variables
-- ======================
local active, savedCF = false, nil
local platform, walls, props = nil, {}, {}

-- Safe Zone Helper Functions
local function clearZone()
    if platform then platform:Destroy() platform = nil end
    for _, p in ipairs(walls) do p:Destroy() end
    for _, p in ipairs(props) do p:Destroy() end
    walls, props = {}, {}
end

local function buildCourtyard(y, size, wallH)
    local half = size/2
    platform = Instance.new("Part")
    platform.Name = "SZFloor"
    platform.Size = Vector3.new(size,1,size)
    platform.CFrame = CFrame.new(0,y,0)
    platform.Anchored = true
    platform.CanCollide = true
    platform.Transparency = 1
    platform.Parent = workspace
    -- Walls
    for _, d in ipairs({
        {size,wallH,2,0,y+wallH/2,half},
        {size,wallH,2,0,y+wallH/2,-half},
        {2,wallH,size,half,y+wallH/2,0},
        {2,wallH,size,-half,y+wallH/2,0},
    }) do
        local w = Instance.new("Part")
        w.Size = Vector3.new(d[1],d[2],d[3])
        w.CFrame = CFrame.new(d[4],d[5],d[6])
        w.Anchored = true
        w.CanCollide = true
        w.Transparency = 1
        w.Parent = workspace
        table.insert(walls, w)
    end
end

-- ======================
-- Functional Variables
-- ======================
local noclipEnabled = false
local infJumpEnabled = false
local superSpeedEnabled = false
local normalWalkSpeed = 16
local superSpeedValue = 75

local espEnabled = false
local espFolder = Instance.new("Folder", workspace)
espFolder.Name = "ESP_Highlights"

-- ======================
-- ESP Functions
-- ======================
local function addESP(plr)
    if plr == player then return end
    if espFolder:FindFirstChild(plr.Name) then return end

    local highlight = Instance.new("Highlight")
    highlight.Name = plr.Name
    highlight.FillColor = Color3.fromRGB(255, 0, 0)
    highlight.OutlineColor = Color3.fromRGB(255, 255, 255)
    highlight.FillTransparency = 0.5
    highlight.OutlineTransparency = 0
    highlight.Parent = espFolder

    local function updateTarget()
        if plr.Character then
            highlight.Adornee = plr.Character
        else
            highlight.Adornee = nil
        end
    end

    plr.CharacterAdded:Connect(function() 
        task.wait(1) 
        updateTarget() 
    end)
    updateTarget()
end

local function removeESP()
    for _, obj in ipairs(espFolder:GetChildren()) do
        obj:Destroy()
    end
end

local function toggleESP(state)
    espEnabled = state
    if espEnabled then
        for _, plr in ipairs(Players:GetPlayers()) do
            addESP(plr)
        end
        Players.PlayerAdded:Connect(addESP)
    else
        removeESP()
    end
end

-- ======================
-- Tab 1: Quick Util
-- ======================
local QuickTab = Window.CreateTab("Quick Util")
QuickTab.CreateDivider("Common Hacks Here")

QuickTab.CreateToggle("Infinite Jump", function(state)
    infJumpEnabled = state
end)

QuickTab.CreateButton("Attach", function()
    print("[Quick Util] Attach pressed (placeholder)")
end)

QuickTab.CreateToggle("Safe Zone Button", function(state)
    if state then
        if not screenGui:FindFirstChild("DragButton") then
            local btn = Instance.new("TextButton")
            btn.Name = "DragButton"
            btn.Size = UDim2.new(0,50,0,50)
            btn.Position = UDim2.new(0.4,0,0.4,0)
            btn.BackgroundColor3 = Color3.fromRGB(0,200,0)
            btn.BackgroundTransparency = 0.5
            btn.BorderSizePixel = 0
            btn.Text = ""
            btn.Active = true
            btn.Draggable = true
            btn.ZIndex = 10
            btn.Parent = screenGui

            local label = Instance.new("TextLabel", btn)
            label.Size = UDim2.new(1,0,1,0)
            label.BackgroundTransparency = 1
            label.Text = "S"
            label.Font = Enum.Font.SourceSansBold
            label.TextSize = 24
            label.TextColor3 = Color3.new(1,1,1)
            label.ZIndex = 11

            btn.MouseButton1Click:Connect(function()
                local char = player.Character
                local hrp = char and char:FindFirstChild("HumanoidRootPart")
                if not hrp then return end
                if not active then
                    savedCF = hrp.CFrame
                    buildCourtyard(1000,80,25)
                    hrp.CFrame = CFrame.new(0,1005,0)
                    active = true
                else
                    if savedCF then hrp.CFrame = savedCF end
                    clearZone()
                    active = false
                end
            end)
        end
    else
        local btn = screenGui:FindFirstChild("DragButton")
        if btn then btn:Destroy() end
    end
end)

QuickTab.CreateToggle("No Clip", function(state)
    noclipEnabled = state
end)

-- ======================
-- Tab 2: Zenith
-- ======================
local ZenithTab = Window.CreateTab("Zenith")
ZenithTab.CreateDivider("Zenith Hacks")

local superSpeedSlider = nil
ZenithTab.CreateToggle("Super Speed", function(state)
    superSpeedEnabled = state
    if state then
        if not superSpeedSlider then
            superSpeedSlider = ZenithTab.CreateSlider("Speed Value", 16, 200, function(val)
                superSpeedValue = val
            end)
        end
    else
        if superSpeedSlider then
            superSpeedSlider:Destroy()
            superSpeedSlider = nil
        end
    end
end)

ZenithTab.CreateButton("Freeze", function()
    print("[Zenith] Freeze (placeholder)")
end)

ZenithTab.CreateToggle("ESP", function(state)
    toggleESP(state)
end)

-- ======================
-- Tab 3: Ink Game
-- ======================
local InkTab = Window.CreateTab("Ink Game")
InkTab.CreateDivider("Game Utilities")

InkTab.CreateButton("Teleport", function()
    print("[Ink Game] Teleport (placeholder)")
end)

-- UI Toggle
ZenithTab.CreateKeybind("Toggle UI", Enum.KeyCode.RightAlt, function()
    Library:ToggleUI()
end)

-- ======================
-- Functional Loops
-- ======================
-- Infinite Jump
UIS.JumpRequest:Connect(function()
    if infJumpEnabled then
        local hum = player.Character and player.Character:FindFirstChildOfClass("Humanoid")
        if hum then hum:ChangeState(Enum.HumanoidStateType.Jumping) end
    end
end)

-- No Clip (light)
RunService.Stepped:Connect(function()
    if noclipEnabled and player.Character then
        for _, part in pairs(player.Character:GetDescendants()) do
            if part:IsA("BasePart") and part.CanCollide then
                part.CanCollide = false
            end
        end
    end
end)

-- Continuous Super Speed
RunService.RenderStepped:Connect(function()
    local hum = player.Character and player.Character:FindFirstChildOfClass("Humanoid")
    if hum then
        hum.WalkSpeed = superSpeedEnabled and superSpeedValue or normalWalkSpeed
    end
end)
